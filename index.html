<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="css/index.css">

    <title>Progress Station</title>
</head>
<body id="body" class="sci-fi background-space">
<section id="star-background" class="stars-active">
    <div class="stars" id="stars1"></div>
    <div class="stars" id="stars2"></div>
    <div class="stars" id="stars3"></div>
    <div class="stars" id="stars4"></div>
    <div id="main-planet-wrapper">
        <img id="main-planet" alt="Blue Planet Illustration" src="img/planets/blue-planet.svg">
    </div>
    <img id="moon" alt="Moon Illustration" src="img/planets/moon.svg">
    <img id="gas-planet" alt="Gas Planet Illustration" src="img/planets/gas-planet.svg">
    <div id="main-planet-overlay"></div>
</section>

<h1 id="gameTitle" class="panel p-2">Progress Station</h1>
<main id="main" class="d-flex flex-column">
    <header id="stationOverview" class="panel my-3 px-3 py-2 d-flex flex-column">
        <div class="d-flex flex-row gap-3 align-items-start">
            <h2 id="nameDisplay" class="m-0 flex-fill">USS Progress</h2>
            <div class="primary-stat">
                <span class="label">Intergalactic cycles:</span>
                <data id="ageDisplay" value="14">14</data>
                <data id="dayDisplay" value="0">0</data>
            </div>
            <div class="secondary-stat help-text">
                <span class="label">Station age:</span>
                <data id="stationAge" value="70">70</data>
                <data value="">kIC</data>
            </div>
        </div>

        <div id="energyGridDisplay" class="d-flex flex-row">
            <div class="d-flex flex-column mt-3">
                <p id="gridLabel" class="grid-strength-bar d-flex align-items-center px-2" style="background-color: grey">
                    <img src="img/icons/grid.svg" class="icon" alt="Grid Icon" style="height: 30px;" />
                    <span class="flex-fill ms-1">Grid</span>
                </p>
                <p class="energy-bar d-flex align-items-center px-2" style="background-color: grey">
                    <img src="img/icons/energy.svg" class="icon" alt="Energy Icon"/>
                    <span class="flex-fill ms-1">Energy</span>
                </p>
            </div>

            <div class="flex-fill">
            <div class="ticks d-flex justify-content-between align-items-end">
                <template id="tickTemplate"><div class="tick"></div></template>
                <slot id="ticksTop"></slot>
            </div>

            <template id="gridStrengthBoxTemplate" class="keep">
                <div class="grid-strength-box flex-grow-1"></div>
            </template>
            <div id="gridStrength" class="grid-strength-bar position-relative d-flex flex-row" style="gap: 3px">
                <!-- Maybe grey box left "Grid" + icon -->
                <p class="gridLoad position-absolute px-2" style="left: 0">
                    <span>Load:</span>
                    <data value="0">0</data>
                </p>
                <p class="gridStrength position-absolute px-2" style="right: 0">
                    <span>Strength:</span>
                    <data value="0">0</data>
                </p>
                <!-- grid-strength-boxes will be appended here -->
            </div>

            <div id="energyDisplay" class="energy-bar progress progressBar" role="progressbar" aria-label="Energy"
                 aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                <div class="progressFill current progress-bar progress-bar-striped" style="width: 0"></div>
                <div class="progress-text energyGenerated px-2">
                    <data value="0" data-unit="W">+0</data>
                    <span>/cycle</span>
                </div>
                <div class="progress-text energyLeft px-2 end-0">
                    <data value="0" data-unit="W">+0</data>
                    <span>until increase</span>
                </div>
            </div>

            <div class="ticks d-flex justify-content-between align-items-start">
                <slot id="ticksBottom"></slot>
            </div>
            </div>
        </div>

        <div id="attributesDisplay" class="row justify-content-center" onclick="setTab('attributes');">
            <div class="col primary-stat" data-attribute="population"
                 data-bs-placement="bottom" data-bs-html="true">
                <img src="" class="icon" alt=""/>
                <span class="label" style=""></span>
                <div>
                    <data id="populationDisplay" value="1">?</data>
                    (x<data id="populationProgressSpeedDisplay" value="1">?</data>)
                </div>
            </div>
            <div class="col primary-stat" data-attribute="industry"
                 data-bs-placement="bottom" data-bs-html="true">
                <img src="" class="icon" alt=""/>
                <span class="label" style=""></span>
                <data id="industryDisplay" value="1">?</data>
            </div>
            <div class="col primary-stat" data-attribute="research"
                 data-bs-placement="bottom" data-bs-html="true">
                <img src="" class="icon" alt=""/>
                <span class="label" style=""></span>
                <data id="researchDisplay" value="1">?</data>
            </div>
            <div class="col primary-stat" data-attribute="growth"
                 data-bs-placement="bottom" data-bs-html="true">
                <img src="" class="icon" alt=""/>
                <span class="label" style=""></span>
                <data id="growthDisplay" value="1">?</data>
            </div>
            <div class="col primary-stat" data-attribute="heat"
                 data-bs-placement="bottom" data-bs-html="true">
                <img src="" class="icon" alt=""/>
                <span class="label" style=""></span>
                <data id="heatDisplay" style="color: rgb(15, 105, 207)" value="1">?%</data>
            </div>
            <div class="col primary-stat" data-attribute="danger"
                 data-bs-placement="bottom" data-bs-html="true">
                <img src="" class="icon" alt=""/>
                <span class="label" style=""></span>
                <data id="dangerDisplay" value="1">?</data>
            </div>
            <div class="col primary-stat" data-attribute="military"
                 data-bs-placement="bottom" data-bs-html="true">
                <img src="" class="icon" alt=""/>
                <span class="label" style=""></span>
                <data id="militaryDisplay" value="1">?</data>
            </div>
        </div>
    </header>

    <div id="contentWrapper" class="d-flex align-content-start" style="max-height: calc(100vh - 192px)">
        <aside id="sidebar" class="mh-100 overflow-x-hidden overflow-y-auto mb-3">
            <div id="actions" class="panel d-flex flex-column p-3">
                <div class="d-flex flex-row gap-3">
                    <div class="flex-fill">
                        <button class="btn btn-secondary btn-lg w-100" id="pauseButton" onClick="togglePause();">
                            Pause
                        </button>
                    </div>
                </div>
            </div>
            <nav class="mt-3 d-flex flex-column gap-1">
                <button id="modulesTabButton" class="tabButton panel p-3" onClick="setTab('modules');">
                    <!--suppress HtmlUnknownTag -->
                    <h3>Modules</h3>

                    <template id="moduleQuickTaskDisplayTemplate">
                        <div class="quickTaskDisplayContainer hidden">
                            <h4 class="fs-6 text-start moduleName mb-0 mt-3">Module</h4>
                            <slot id="componentsQuickTaskDisplay"></slot>
                        </div>
                    </template>

                    <template id="componentQuickTaskDisplayTemplate">
                        <div class="quickTaskDisplay mt-2" title="Component: Operation" data-bs-placement="bottom">
                            <div class="progress progressBar" role="progressbar" aria-label="Task" aria-valuenow="0"
                                 aria-valuemin="0" aria-valuemax="100">
                                <div class="operationQuickDisplay progressFill current progress-bar progress-bar-striped" style="width: 0"></div>
                                <div class="progress-text name d-flex px-2">
                                    <span class="component text-truncate">Component</span>
                                    <span class="me-1">:</span>
                                    <span class="operation text-truncate me-1">Operation</span>
                                    <span class="me-1">lvl</span>
                                    <data value="0" class="level">0</data>
                                </div>
                            </div>
                        </div>
                    </template>
                    <slot id="modulesQuickTaskDisplay"></slot>
                </button>
                <button id="battleTabButton" class="tabButton panel p-3" onClick="setTab('battles');">
                    <!--suppress HtmlUnknownTag -->
                    <h3>Battle</h3>
                    <template id="battleQuickTaskDisplayTemplate">
                        <div class="quickTaskDisplay mt-2">
                            <div class="progress battle progressBar" role="progressbar" aria-label="Task" aria-valuenow="0"
                                 aria-valuemin="0" aria-valuemax="100">
                                <div class="progressBackground progress-background"></div>
                                <div class="battleQuickDisplay progressFill current progress-bar progress-bar-striped" style="width: 0"></div>
                                <div class="progress-text px-2">
                                    <span class="name">Battle</span>
                                    <span>lvl</span>
                                    <data value="0" class="level">0</data>
                                </div>
                            </div>
                        </div>
                    </template>
                    <slot id="battlesQuickTaskDisplay"></slot>
                </button>
                <button id="locationTabButton" class="tabButton panel p-3" onClick="setTab('location');">
                    <!--suppress HtmlUnknownTag -->
                    <h3>Location</h3>
                </button>
                <button id="captainsLogTabButton" class="tabButton panel p-3 hidden" onClick="setTab('captainsLog');">
                    <!--suppress HtmlUnknownTag -->
                    <h3>Captain's Log</h3>
                </button>
                <button id="galacticSecretsTabButton" class="tabButton panel p-3" onClick="setTab('galacticSecrets');">
                    <!--suppress HtmlUnknownTag -->
                    <h3>Galactic Secrets</h3>
                    <div class="col primary-stat d-flex justify-content-center mt-2" data-attribute="essenceOfUnknown"
                         data-bs-placement="bottom" data-bs-html="true">
                        <img src="" class="icon me-1" alt=""/>
                        <span class="label" style=""></span>
                        <span class="me-1">: </span>
                        <data id="essenceOfUnknownDisplay" value="0">?</data>
                    </div>
                </button>
                <button id="attributesTabButton" class="tabButton panel p-3" onClick="setTab('attributes');">
                    <!--suppress HtmlUnknownTag -->
                    <h3>Attributes</h3>
                </button>
                <button id="settingsTabButton" class="tabButton panel p-3" onClick="setTab('settings');">
                    <!--suppress HtmlUnknownTag -->
                    <h3>Settings</h3>
                </button>
            </nav>
        </aside>

        <div id="content" class="panel flex-fill position-relative mh-100 overflow-auto mb-3">
            <template id="level1Template">
                <div class="level1">
                    <div class="level1-header d-flex justify-content-start py-2 px-2 mb-0"
                         style="background-color: rgb(199, 21, 133);">
                        <div class="category" title="Component Description" data-bs-placement="right">
                            Industry
                        </div>
                    </div>

                    <slot id="level2"></slot>
                    <div class="ps-4">
                        <slot id="level2Requirements"></slot>
                    </div>
                </div>
            </template>

            <template id="level2Template">
                <div class="level2 ps-3 mt-2">
                    <div class="level2-header bg-light text-dark d-flex justify-content-start align-items-center px-2 gap-3"
                         style="padding-top: 5px; padding-bottom: 5px;">
                        <div class="name" title="Component Description" data-bs-placement="right">
                            Mining Bay
                        </div>
                        <div>
                            Level:
                            <data class="level" value="32">32</data>
                        </div>
                        <div>
                            <div class="form-check form-switch form-check-reverse">
                                <input class="form-check-input moduleActivationSwitch" type="checkbox" role="switch" id="switch1" checked>
                                <label class="form-check-label moduleActivationLabel" for="switch1">Active</label>
                            </div>
                        </div>
                        <div class="gridLoad ms-auto">
                            Total grid load:
                            <data value="3">3</data>
                        </div>
                    </div>

                    <slot id="level3"></slot>
                </div>
            </template>

            <template id="level3TaskTemplate">
                <div class="table-container ps-3 mt-2">
                    <table class="table mb-0">
                        <thead class="level3">
                        <tr class="header-row">
                            <th class="name" title="Component Description" data-bs-placement="right">
                                Drills
                            </th>
                            <th>Level</th>
                            <th>Effect</th>
                            <th>Xp/Cycle</th>
                            <th>Xp left</th>
                            <th>Grid Load</th>
                            <th class="maxLevel">Max level</th>
                        </tr>
                        </thead>
                        <tbody class="level4">
                            <!-- repeat level 4 row -->
                        </tbody>
                    </table>
                </div>
            </template>

            <template id="level3BattleTemplate">
                <div class="table-container ps-3 mt-2">
                    <table class="table mb-0">
                        <thead class="level3">
                        <tr class="header-row">
                            <th class="name">Battles</th>
                            <th class="action">Engaged</th>
                            <th class="level">Level</th>
                            <th class="xpGain">Dmg</th>
                            <th class="xpLeft">HP left</th>
                            <th class="danger">Danger</th>
                            <th class="rewards">Reward</th>
                        </tr>
                        </thead>
                        <tbody class="level4">
                        <!-- repeat level 4 row -->
                        </tbody>
                    </table>
                </div>
            </template>

            <template id="level3PointOfInterestTemplate">
                <div class="table-container ps-3">
                    <table class="table mb-0">
                        <thead class="level3">
                        <tr class="header-row">
                            <th class="name" title="Sector Description" data-bs-placement="right">
                                Sector
                            </th>
                            <th>Stationed</th>
                            <th>Effect</th>
                            <th>Modifier</th>
                            <th>Danger</th>
                        </tr>
                        </thead>
                        <tbody class="level4">
                            <!-- repeat level 4 row -->
                        </tbody>
                    </table>
                </div>
            </template>

            <template id="level4TaskTemplate">
                <tr>
                    <td>
                        <div class="progress progressBar descriptionTooltip" role="progressbar" aria-label="Task"
                             aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" title="Task Description"
                             data-bs-placement="right">
                            <div class="moduleOperation progressFill progress-bar progress-bar-striped" style="width: 54%"></div>
                            <div class="progress-text name px-2 text-truncate">Basic Bitch Co. Drills</div>
                        </div>
                    </td>
                    <td class="level">
                        <data value="53">53</data>
                    </td>
                    <td class="effect">
                        x1.13 Industry
                    </td>
                    <td class="xpGain">
                        <data value="1600" data-unit="k">1.6</data>
                    </td>
                    <td class="xpLeft">
                        <data value="4550" data-unit="k">45.5</data>
                    </td>
                    <td class="gridLoad">
                        <data value="1">1</data>
                    </td>
                    <td class="maxLevel">
                        <data value="124">124</data>
                    </td>
                </tr>
            </template>

            <template id="level4BattleTemplate">
                <tr>
                    <td>
                        <div class="progress battle progressBar descriptionTooltip" role="progressbar" aria-label="Task"
                             aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" title="Learn something about astrogoblins."
                             data-bs-placement="right">
                            <div class="progressBackground progress-background"></div>
                            <div class="battleProgress progressFill progress-bar progress-bar-striped" style="width: 54%"></div>
                            <div class="progress-text name px-2">Wimpy Astrogoblins</div>
                        </div>
                    </td>
                    <td class="action">
                        <div class="radio">
                            <div class="active"></div>
                        </div>
                    </td>
                    <td class="level">
                        <data value="53">53</data>
                    </td>
                    <td class="xpGain">
                        <data value="1600" data-unit="k">1.6</data>
                    </td>
                    <td class="xpLeft">
                        <data value="4550" data-unit="k">45.5</data>
                    </td>
                    <td class="danger">
                        <data value="200">200</data>
                    </td>
                    <td class="rewards">
                        +2.0 Research
                    </td>
                </tr>
            </template>

            <template id="level4PointOfInterestTemplate">
                <tr>
                    <td style="width: 16rem">
                        <button class="button btn btn-dark btn-sm w-100 descriptionTooltip" aria-label="Item"
                                title="Description" data-bs-placement="right">
                            <span class="name"></span>
                        </button>
                    </td>
                    <td>
                        <div class="radio">
                            <div class="active"></div>
                        </div>
                    </td>
                    <td class="effect"></td>
                    <td class="modifier"></td>
                    <td class="danger">
                        <data value="200">200</data>
                    </td>
                </tr>
            </template>

            <template id="level4GalacticSecretTemplate">
                <tr>
                    <td>
                        <div class="galactic-secret progress progressBar descriptionTooltip" role="progressbar" aria-label="Task"
                             aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" title="Task Description"
                             data-bs-placement="right">
                            <div class="moduleOperation progressFill progress-bar progress-bar-striped" style="width: 54%"></div>
                            <div class="progress-text d-flex px-2">
                                <span class="unlocked-icon me-1">ðŸ—¹</span>
                                <span class="component text-truncate">Component</span>
                                <span class="me-1">:</span>
                                <span class="operation text-truncate">Secret Operation</span>
                            </div>
                        </div>
                    </td>
                    <td class="parent">
                        Module
                    </td>
                    <td class="effect">
                        x1.13 Industry, +4.50 Energy
                    </td>
                    <td class="gridLoad">
                        <data value="1">1</data>
                    </td>
                </tr>
            </template>

            <template id="level4RequiredTemplate">
                <tr>
                    <td class="requirements help-text ps-3" colspan="100%">
                        Required:
                        <span class="rendered"></span>
                    </td>
                </tr>
            </template>

            <template id="requirementsTemplate">
                <div class="requirements help-text">
                    Required:
                    <span class="rendered"></span>
                </div>
            </template>

            <div id="modules" class="tab p-3">
                <slot id="modulesTable"></slot>
                <slot id="moduleCategoryRequirements"></slot>
            </div>

            <div id="battles" class="tab p-3 overflow-hidden">
                <slot id="battlesTable"></slot>
            </div>

            <div id="location" class="tab p-3">
                <slot id="sectorTable"></slot>
                <slot id="sectorRequirements"></slot>
            </div>

            <div id="captainsLog" class="tab p-3">
                <ul>
                    <li>
                        You stumble across a strange looking amulet on your 25th birthday. It does not look like
                        it has any worth on the market given that it's made from cheap-looking copper. However, you
                        feel a weird urge to keep the amulet, so you slip it into your pocket for safekeeping.
                    </li>
                    <li class="mt-2" id="rebirthNote1">
                        On your 45th birthday, you feel the amulet shiver uncontrollably in your pocket. You take it
                        out and the constant shivering suddenly stops. More to your bizarre surprise, you notice
                        a strange etching on the centre of the amulet.
                    </li>
                    <li class="mt-2" id="rebirthNote2">
                        <p>
                            On your 65th birthday, you once again encounter the strange, unexplained shivering from your
                            amulet. But this time, a living eyeball emerges from the centre. Although terribly
                            frightened,
                            you realise you do not have many years to live left anyway, so you consider touching the eye
                            to see what happens.
                        </p>
                        <p class="mt-2 help-text">
                            By touching the eyeball, you will be reborn and have to restart life again, losing all your
                            levels and stored energy.
                            However, you will gain <b>xp multipliers</b> for your modules and skills equivalent to:
                            <b>1 + the max level of the skill or job / 10.</b>
                            This means you will learn everything again much more quickly than you did in your previous
                            life.
                        </p>
                        <p style="color: rgb(200, 0, 0)">
                            Something tells you that the amulet might transform even
                            further after living for <b>2 whole centuries</b>&hellip;
                        </p>
                        <button class="btn btn-light mt-3" onClick="startNewPlaythrough();">
                            Touch the eye
                        </button>
                    </li>
                    <li class="mt-2" id="rebirthNote3">
                        <p>
                            Your gut instinct was right. The moment you hit the grand age of 200, you hear an ominous
                            hum coming from the amulet.<br/>
                            A mouth emerges from its surface and begins to cackle, and proceeds to say: <i>"So you've made
                            it this far... Are you ready to embrace evil?"</i>
                        </p>
                        <p class="mt-2" style="color: rgb(200, 0, 0)">
                            If you decide to embrace evil, all of your levels, stored energy and even max levels will be
                            reset.
                            You will be reborn as a fresh slate. However, you will unlock a new line of skills and gain
                            <b><data id="evilGainDisplay" value="0">0</data> evil</b>, which will heavily impact your
                            future lives.
                        </p>
                        <button class="btn btn-light mt-3" onClick="rebirthTwo();">
                            Embrace evil
                        </button>
                    </li>
                </ul>
            </div>

            <div id="galacticSecrets" class="tab p-3">
                <ul class="galactic-secrets-help-text help-text m-0">
                    <li>Unravel a Galactic Secret by long pressing its progress bar.</li>
                    <li style="transform-origin: left">Each Secret costs
                        <data id="galacticSecretCostDisplay" value="1" class="text-body">1</data>
                        <span class="label" style="color: rgb(171, 1, 110); font-weight: 400;">Essence of Unknown</span>
                        currently.
                    </li>
                    <li>After unraveling a Secret, the cost per Secret will increase <data value="3" class="text-body">x3</data>.</li>
                </ul>
                <div class="table-container ps-3">
                    <table class="table mb-0">
                        <thead class="level3">
                        <tr class="header-row">
                            <th class="name" title="Galactic Secret Description" data-bs-placement="right">
                                Galactic Secret
                            </th>
                            <th>Belongs to</th>
                            <th>Effect</th>
                            <th>Grid Load</th>
                        </tr>
                        </thead>
                        <tbody class="level4">
                        <!-- repeat level4GalacticSecretTemplate -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="attributes" class="tab p-3">
                <!-- TODO: boxed design for mobile -> be able to have 1 attribute per row -->
                <table class="table">
                    <thead>
                    <tr>
                        <th class="text-nowrap">Attribute</th>
                        <th class="text-nowrap">Value</th>
                        <th class="text-nowrap">Breakdown</th>
                        <th class="text-nowrap">Description</th>
                    </tr>
                    </thead>
                    <template id="attributeRowTemplate">
                        <tr>
                            <td class="title">
                                <img src="img/icons/industry.svg" class="icon" alt="Population Icon"/>
                                <span class="name" style="color: rgb(97, 173, 50)">Industry</span>
                            </td>
                            <td>
                                <data value="0" class="value">?</data>
                            </td>
                            <td class="breakdown"
                                style="line-height: 1.1rem; padding-top: 0.3rem; padding-bottom: 0.3rem;">
                                <ul class="balance hidden m-0 list-unstyled">
                                    <!-- Repeat balanceEntry -->
                                </ul>

                                <p class="formula hidden">
                                </p>
                            </td>
                            <td class="description"></td>
                        </tr>
                    </template>
                    <template id="balanceEntryTemplate">
                        <li class="balanceEntry">
                            <span class="operator"></span>
                            <data value="0" class="entryValue">?</data>
                            <span class="name"></span>
                        </li>
                    </template>
                    <tbody id="attributeRows">
                    </tbody>
                </table>
            </div>

            <div id="settings" class="tab p-3">
                <div class="row">
                    <label for="settingsStationNameInput" class="col-sm-2 col-form-label">Station Name</label>
                    <div class="col-sm-10">
                        <input type="text"
                               id="settingsStationNameInput"
                               class="stationNameInput form-control"
                               maxlength="30"
                               placeholder=""/>
                        <button class="btn btn-light py-1 mt-3 float-end" onClick="rerollStationName();">Re-roll</button>
                    </div>
                </div>

                <div class="row mt-3">
                    <label for="importExportBox" class="col-sm-2 col-form-label">Import/export save</label>
                    <div class="col-sm-10">
                        <textarea id="importExportBox" class="form-control" rows="3"></textarea>

                        <div class="mt-3 float-end">
                            <button class="btn btn-light py-1" onClick="gameData.import();">Import</button>
                            <button class="btn btn-light py-1" onClick="gameData.export();">Export</button>
                        </div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-sm-2">Performance</div>
                    <div class="col-sm-10">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox"
                                   role="switch" id="vfxProgressBarFollowSwitch"
                                    onclick="toggleVfxFollowProgressBars();">
                            <label class="form-check-label" for="vfxProgressBarFollowSwitch">
                                Particles on progress bars
                            </label>
                        </div>
                    </div>
                </div>

                <div class="row mt-3 hidden">
                    <div class="col-sm-2 col-form-label">Light/dark mode</div>
                    <div class="col-sm-10">
                        <div class="btn-group">
                            <button class="btn btn-light py-1" onClick="toggleLightDarkMode(false);">Light</button>
                            <button class="btn btn-dark py-1" onClick="toggleLightDarkMode(true);">Dark</button>
                        </div>
                    </div>
                </div>

                <div class="row mt-3 hidden">
                    <div class="col-sm-2 col-form-label unstable">Sci-fi mode</div>
                    <div class="col-sm-10">
                        <div class="btn-group">
                            <button class="btn btn-light py-1" onClick="toggleSciFiMode(true);">On</button>
                            <button class="btn btn-primary py-1" onClick="toggleSciFiMode(false);">Off</button>
                        </div>
                    </div>
                </div>

                <div class="row mt-3 hidden">
                    <div class="col-sm-2 col-form-label unstable">Background</div>
                    <div class="col-sm-10">
                        <div class="form-check background background-simple" onclick="setBackground('simple');">
                            <input class="form-check-input" type="radio" name="background" id="radioBackground1">
                            <label class="form-check-label" for="radioBackground1">
                                Simple Color
                            </label>
                        </div>
                        <div class="form-check background background-triangles1" onClick="setBackground('triangles1');">
                            <input class="form-check-input" type="radio" name="background" id="radioBackground2">
                            <label class="form-check-label" for="radioBackground2">
                                Trianglify
                            </label>
                        </div>
                        <div class="form-check background background-space" onClick="setBackground('space');">
                            <input class="form-check-input" type="radio" name="background" id="radioBackground3">
                            <label class="form-check-label" for="radioBackground3">
                                Space
                            </label>
                        </div>
                        <div class="form-check background background-hexagons" onClick="setBackground('hexagons');">
                            <input class="form-check-input" type="radio" name="background" id="radioBackground4">
                            <label class="form-check-label" for="radioBackground4">
                                Bestagons
                            </label>
                        </div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-sm-2 col-form-label">Credits</div>
                    <div class="col-sm-10">
                        <p>
                            A game by <a href="http://kringel.games/" target="_blank">Kringel Games</a>
                            <small class="help-text">(link opens in new tab)</small>.
                        </p>

                        <table class="table  table-borderless table-striped align-middle w-auto">
                            <tbody>
                            <tr>
                                <th class="ps-0">Vision Keeper &amp;amp; Visual Coder</th>
                                <td>Raoul</td>
                            </tr>
                            <tr>
                                <th class="ps-0">Feature Coder</th>
                                <td>Mark</td>
                            </tr>
                            <tr>
                                <th class="ps-0">Initial Vision</th>
                                <td>Janik</td>
                            </tr>
                          <!-- <tr>
                                <th class="ps-0">Game Designer</th>
                                <td>Gino</td>
                            </tr> -->
                            <tr>
                                <th class="ps-0">Dev Ops</th>
                                <td>Pauline</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-sm-2 col-form-label">Hard reset game</div>
                    <div class="col-sm-10">
                        <button class="btn btn-danger py-1" onClick="gameData.reset();">Reset</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<div id="versionWarningModal" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title fs-4 fw-light">Incompatible Save Game found</h2>
            </div>
            <div class="modal-body">
                <p>You have already played <b>Progress Station</b> in the past, thank you!</p>
                <p>The game has evolved a lot since then and we can not guarantee that your save game is still fully compatible.</p>
                <p>Our recommendation is to start with a fresh game. But you can also try and let the game reuse your save file.</p>
            </div>
            <div class="modal-footer d-flex">
                <div>
                    <button type="button" class="btn btn-warning" onclick="continueWithIncompatibleVersion();">
                        Keep save
                    </button>
                    <p><small>(might break the game)</small></p>
                </div>
                <div class="ms-auto">
                    <button type="button" class="btn btn-primary" onclick="gameData.reset();">
                        Reset game
                    </button>
                    <p><small>(deletes all progress)</small></p>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="storyIntroModal" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title fs-4 fw-light">Welcome to Progress Station</h2>
            </div>
            <div class="modal-body">
                <p>You awake on a dimly lit, emergency-powered bridge of what appears
                    to be a heavily damaged space station.
                <p>
                <p>
                    Through the glazed front you see not only large parts of the station
                    as they drift away destroyed through space, but also a many-limbed,
                    dark mass that disappears silently into the vastness of space.
                    At least for now.
                <p>
                <p>
                    <label for="introStationNameInput">A name flashes on the main console:</label>
                </p>
                <input type="text"
                       id="introStationNameInput"
                       class="stationNameInput w-100"
                       maxlength="30"
                       placeholder=""/>
            </div>
            <div class="modal-footer d-flex">
                <button type="button" id="rerollName" class="btn btn-secondary">Re-roll name</button>
                <button type="button" class="btn btn-primary ms-auto" onclick="finishIntro();">Take control</button>
            </div>
        </div>
    </div>
</div>

<div id="bossAppearanceModal" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title fs-4 fw-light">An ancient evil approaches</h2>
            </div>
            <div class="modal-body">
                <p>
                    Everything was going great on your space station, but suddenly your
                    heart sinks into your stomach, and you get that same feeling as when
                    you came to your senses alone on this very station.
                </p>
                <p>
                    Sensors are going wild, the proximity alert shrieks and the light of stars
                    gets swallowed by an unidentifiable mass.
                </p>
                <p class="help-text">
                    In <data value="4">4</data> battles or <data value="800">800</data> cycles
                    (whichever happens first) the boss battle will start.
                </p>
            </div>
            <div class="modal-footer d-flex">
                <button type="button" class="btn btn-primary ms-auto" onclick="acknowledgeBossBattle();">Prepare!</button>
            </div>
        </div>
    </div>
</div>

<div id="bossFightIntroModal" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title fs-4 fw-light"><b>The Destroyer</b> attacks you</h2>
            </div>
            <div class="modal-body">
                <p>
                    You are facing an immense, dark mass of writhing tentacles, teeth and eyes that are fixated on the station.
                </p>
                <p>
                    The vacuum of space around your station suppresses all noise, but you can feel the hatred of
                    the alien beast and see it's determination to destroy everything you have built up.
                </p>
            </div>
            <div class="modal-footer d-flex">
                <button type="button" class="btn btn-secondary"
                        id="delayBossBattleButton" onclick="delayBossBattle();">
                    Not yet
                </button>
                <button type="button" class="btn btn-primary ms-auto" onclick="startBossBattle();">Fight!</button>
            </div>
        </div>
    </div>
</div>

<div id="gameOverModal" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title fs-4 fw-light win-only">You defeated <b>The Destroyer</b></h2>
                <h2 class="modal-title fs-4 fw-light loss-only"><b>The Destroyer</b> defeated you</h2>
            </div>
            <div class="modal-body win-only">
                <p>
                    Congratulations!
                </p>
                <p>
                    You managed to blast through the Destroyer's near endless defenses.
                </p>
                <p>
                    The universe is safe, and it feels as if a curse was lifted of your soul.
                </p>
                <p class="mt-4">
                    On the main console you see what appears to be an ancient video game:
                </p>
                <p class="text-center mb-0">
                    <a href="https://ihtasham-42.itch.io/progress-knight">Progress Knight</a> by ihtasham_42<br/>
                </p>
                <p>
                    <em class="help-text">Check out the original game that Progress Station is based upon.</em>
                </p>
            </div>
            <div class="modal-body loss-only">
                <p>
                    The Destroyer's power is overwhelming and annihilates your man, your station, everything.
                </p>
                <p>
                    With the last of your strength, you save yourself in the rescue capsule.
                </p>
                <p class="help-text">
                    In the next play-through, you will progress much faster.<br/>
                    The max level of modules equals the sum of all operations in that module.<br/>
                    Each operation in a modules progresses X% faster, where X is the modules max level.
                </p>
            </div>
            <div class="modal-footer d-flex">
                <button type="button" class="btn btn-secondary win-only" onclick="continueAfterWin();">Keep playing</button>
                <button type="button" class="btn btn-primary ms-auto win-only" onclick="resetAfterWin();">Start new game</button>
                <button type="button" class="btn btn-primary ms-auto loss-only" onclick="restartAfterDead();">Fade to black</button>
            </div>
        </div>
    </div>
</div>

<!-- Do not include background timer during local development -> it makes debugging a pain -->
<!--<script type="text/javascript" src="vendor/hacktimer-1.1.3/HackTimer.min.js"></script>-->
<script type="text/javascript" src="vendor/fastdom-1.0.11/fastdom.min.js"></script>
<script type="text/javascript" src="vendor/fastdom-1.0.11/extensions/fastdom-promised.js"></script>
<script type="text/javascript">
    // extend fastdom
    const XFastdom = fastdom.extend(fastdomPromised);
</script>
<script type="text/javascript" src="vendor/bootstrap-5.3.1/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="vendor/lodash-4.17.15/lodash.min.js"></script>
<script type="text/javascript" src="vendor/p5.Color.js"></script>
<script type="text/javascript" src="js/utils.js"></script>
<script type="text/javascript" src="js/gameEvents.js"></script>
<!-- TODO remove for release -->
<script type="text/javascript" src="js/cheats.js"></script>
<script type="text/javascript" src="js/effects.js"></script>
<script type="text/javascript" src="js/classes.js"></script>
<script type="text/javascript" src="js/battle.js"></script>
<script type="text/javascript" src="js/gameConfig.js"></script>
<script type="text/javascript" src="js/nameGenerator.dictionary.lighthearted.js"></script>
<script type="text/javascript" src="js/nameGenerator.js"></script>
<script type="text/javascript" src="js/story.js"></script>
<script type="text/javascript" src="js/gameData.js"></script>
<script type="text/javascript" src="js/main.js"></script>
<script type="text/javascript" src="js/vfx.js"></script>
</body>
</html>
